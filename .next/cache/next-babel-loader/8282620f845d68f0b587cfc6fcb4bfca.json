{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState } from \"react\";\nimport { useQuery } from \"@apollo/react-hooks\";\nimport Router from \"next/router\";\nimport { gql } from \"apollo-boost\";\nimport Select from \"react-select\";\nimport Composer from \"./Composer\";\nimport Pagination from \"../components/Pagination\";\nimport { perPage } from \"../config\";\nimport { SelectButton } from \"primereact/selectbutton\";\nimport { selectButtonsAthruZ } from \"../lib/selectButtons\";\nimport Center from \"./styles/Center\";\nimport MultiList from \"./styles/Multilist\";\nimport sortBySelectItems from \"../lib/sortByOptions/composersSortBySelectOptions\";\nimport customTheme from \"./styles/reactSelectTheme\";\nimport getSelectLabel from \"../lib/sortByOptions/sortBySelectReturnLabel\";\nconst ALL_COMPOSERS_QUERY = gql`\n  query ALL_COMPOSERS_QUERY($skip: Int = 0, $first: Int = ${perPage}, $sortBy: ComposerOrderByInput!) {\n    composers(first: $first, skip: $skip, orderBy: $sortBy ) {\n      id\n      name\n    }\n  }\n`;\nexport const ALL_COMPOSERS_BEGINNING_WITH_QUERY = gql`\n  query ALL_COMPOSERS_BEGINNING_WITH_QUERY($skip: Int = 0, $first: Int = ${perPage}, $letter: String, $sortBy: ComposerOrderByInput!) {\n    composers(where: {name_starts_with: $letter}, first: $first, skip: $skip, orderBy: $sortBy) {\n      id\n      name\n    }\n  }\n`;\n\nconst Composers = ({\n  page\n}) => {\n  const {\n    0: letter,\n    1: setLetter\n  } = useState(\"\");\n  const {\n    0: sortBy,\n    1: setSortBy\n  } = useState(\"name_ASC\");\n  const {\n    loading: allComposersLoading,\n    error: allComposersError,\n    data: allComposersData\n  } = useQuery(ALL_COMPOSERS_QUERY, {\n    variables: {\n      skip: page * perPage - perPage,\n      first: perPage,\n      sortBy\n    }\n  });\n  const {\n    loading: composersBeginningWithLoading,\n    error: composersBeginningWithError,\n    data: composersBeginningWithData\n  } = useQuery(ALL_COMPOSERS_BEGINNING_WITH_QUERY, {\n    variables: {\n      skip: page * perPage - perPage,\n      first: perPage,\n      letter,\n      sortBy\n    }\n  });\n  if (allComposersLoading || composersBeginningWithLoading) return __jsx(\"p\", null, \"Loading...\");\n  if (allComposersError || composersBeginningWithError) return __jsx(\"p\", null, \"Error :(\");\n  const composers = !letter ? allComposersData.composers.map(composer => __jsx(Composer, {\n    key: composer.id,\n    composer: composer\n  })) : composersBeginningWithData.composers.map(composer => __jsx(Composer, {\n    key: composer.id,\n    composer: composer\n  }));\n  return __jsx(Center, null, __jsx(SelectButton, {\n    value: letter,\n    options: selectButtonsAthruZ,\n    onChange: e => {\n      setLetter(e.value);\n      Router.push({\n        pathname: \"/composers\",\n        query: {\n          page: 1\n        }\n      });\n    }\n  }), __jsx(\"br\", null), __jsx(Select, {\n    options: sortBySelectItems,\n    theme: customTheme,\n    placeholder: `Sort by ${getSelectLabel(sortBySelectItems, sortBy)}`,\n    onChange: e => setSortBy(e.value),\n    isSearchable: true\n  }), __jsx(\"br\", null), __jsx(Pagination, {\n    page: page,\n    model: \"composers\",\n    letter: letter\n  }), __jsx(MultiList, null, composers), __jsx(Pagination, {\n    page: page,\n    model: \"composers\",\n    letter: letter\n  }));\n};\n\nexport default Composers;","map":null,"metadata":{},"sourceType":"module"}
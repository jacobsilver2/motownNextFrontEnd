{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState } from \"react\";\nimport Router from \"next/router\";\nimport { useQuery } from \"@apollo/react-hooks\";\nimport { gql } from \"apollo-boost\";\nimport Select from \"react-select\";\nimport makeAnimated from \"react-select/animated\";\nimport { perPage } from \"../config\";\nimport Song from \"../components/Song\";\nimport Pagination from \"../components/Pagination\";\nimport { SelectButton } from \"primereact/selectbutton\";\nimport { selectButtonsAthruZWithNumber } from \"../lib/selectButtons\";\nimport sortBySelectItems from \"../lib/sortByOptions/songsSortBySelectItems\";\nimport Center from \"./styles/Center\";\nimport MultiList from \"./styles/Multilist\";\nimport customTheme from \"./styles/reactSelectTheme\";\nimport getSelectLabel from \"../lib/sortByOptions/sortBySelectReturnLabel\";\nexport const ALL_SONGS_QUERY = gql`\n  query ALL_SONGS_QUERY($skip: Int = 0, $first: Int = ${perPage}, $sortBy: SongOrderByInput!) {\n    songs(first: $first, skip: $skip, orderBy: $sortBy ) {\n      id\n      title\n      publisher\n      publishedDate\n      composer {\n        name\n        id\n      }\n    }\n  }\n`;\nexport const ALL_SONGS_BEGINNING_WITH_QUERY = gql`\n  query ALL_SONGS_BEGINNING_WITH_QUERY($skip: Int = 0, $first: Int = ${perPage}, $letter: String, $sortBy: SongOrderByInput!) {\n    songs(where: {title_starts_with: $letter}, first: $first, skip: $skip, orderBy: $sortBy) {\n      id\n      title\n      publisher\n      publishedDate\n      composer {\n        name\n        id\n      }\n    }\n  }\n`;\nexport const ALL_SONGS_BEGINNING_WITH_NUMBER_QUERY = gql`\n  query ALL_SONGS_BEGINNING_WITH_NUMBER_QUERY($skip: Int = 0, $first: Int = ${perPage}, $sortBy: SongOrderByInput!) {\n    songs(where: {OR: [{title_starts_with: \"0\"},{title_starts_with: \"1\"},{title_starts_with: \"2\"},{title_starts_with: \"3\"},{title_starts_with: \"4\"},{title_starts_with: \"5\"},{title_starts_with: \"6\"},{title_starts_with: \"7\"},{title_starts_with: \"8\"},{title_starts_with: \"9\"}]}, first: $first, skip: $skip, orderBy: $sortBy) {\n      id\n      title\n      publisher\n      publishedDate\n      composer {\n        name\n        id\n      }\n    }\n  }\n`;\n\nconst Songs = ({\n  page\n}) => {\n  const {\n    0: letter,\n    1: setLetter\n  } = useState(\"\");\n  const {\n    0: sortBy,\n    1: setSortBy\n  } = useState(\"title_ASC\");\n  const {\n    loading: allSongsLoading,\n    error: allSongsError,\n    data: allSongsData\n  } = useQuery(ALL_SONGS_QUERY, {\n    variables: {\n      skip: page * perPage - perPage,\n      first: perPage,\n      sortBy\n    }\n  });\n  const {\n    loading: songsBeginningWithLoading,\n    error: songsBeginningWithError,\n    data: songsBeginningWithData\n  } = useQuery(ALL_SONGS_BEGINNING_WITH_QUERY, {\n    variables: {\n      skip: page * perPage - perPage,\n      first: perPage,\n      letter,\n      sortBy\n    }\n  });\n  const {\n    loading: songsBeginningWithNumberLoading,\n    error: songsBeginningWithNumberError,\n    data: songsBeginningWithNumberData\n  } = useQuery(ALL_SONGS_BEGINNING_WITH_NUMBER_QUERY, {\n    variables: {\n      skip: page * perPage - perPage,\n      first: perPage,\n      sortBy\n    }\n  });\n  if (allSongsLoading || songsBeginningWithLoading || songsBeginningWithNumberLoading) return __jsx(\"p\", null, \"Loading...\");\n  if (allSongsError || songsBeginningWithError || songsBeginningWithNumberError) return __jsx(\"p\", null, \"Error :(\");\n  let songs = \"\";\n\n  if (!letter) {\n    songs = allSongsData.songs.map(song => __jsx(Song, {\n      key: song.id,\n      song: song\n    }));\n  } else if (letter === \"#\") {\n    songs = songsBeginningWithNumberData.songs.map(song => __jsx(Song, {\n      key: song.id,\n      song: song\n    }));\n  } else {\n    songs = songsBeginningWithData.songs.map(song => __jsx(Song, {\n      key: song.id,\n      song: song\n    }));\n  }\n\n  return __jsx(Center, null, __jsx(SelectButton, {\n    value: letter,\n    options: selectButtonsAthruZWithNumber,\n    onChange: e => {\n      setLetter(e.value);\n      Router.push({\n        pathname: \"/songs\",\n        query: {\n          page: 1\n        }\n      });\n    }\n  }), __jsx(\"br\", null), __jsx(Select, {\n    options: sortBySelectItems,\n    theme: customTheme,\n    placeholder: `Sort by ${getSelectLabel(sortBySelectItems, sortBy)}`,\n    onChange: e => setSortBy(e.value),\n    isSearchable: true\n  }), __jsx(\"br\", null), __jsx(Pagination, {\n    page: page,\n    model: \"songs\",\n    letter: letter\n  }), __jsx(MultiList, null, songs), __jsx(Pagination, {\n    page: page,\n    model: \"songs\",\n    letter: letter\n  }));\n};\n\nexport default Songs;","map":null,"metadata":{},"sourceType":"module"}